# 要件書

## 概要

TASQプラットフォームの開発・テスト環境において、現実的で包括的なテストデータを自動生成するシードシステムを構築する。このシステムは、学習管理プラットフォームの全機能をテストできるよう、ユーザー、タスク、学習ログ、講師-生徒関係などの関連データを一貫性を保って生成する。

## 要件

### 要件1

**ユーザーストーリー:** 開発者として、異なる役割（学生、TA、講師、管理者）のテストユーザーが自動生成されることで、ロールベースの機能をテストできるようにしたい

#### 受入基準

1. WHEN シードスクリプトを実行 THEN システムは各役割（STUDENT、TA、TEACHER、ADMIN）のユーザーを最低3名ずつ生成 SHALL する
2. WHEN ユーザーを生成 THEN システムは現実的な日本語の名前、SNSアカウント情報、職業情報を設定 SHALL する
3. WHEN 学生ユーザーを生成 THEN システムは現在の学習チャプター（1-10の範囲）を設定 SHALL する
4. WHEN ユーザーを生成 THEN システムはSupabase認証システムにも対応するテストアカウントを作成 SHALL する

### 要件2

**ユーザーストーリー:** 開発者として、多様なタスクデータが生成されることで、タスク管理機能の動作を検証したい

#### 受入基準

1. WHEN シードスクリプトを実行 THEN システムは各学生に対して5-15個のタスクを生成 SHALL する
2. WHEN タスクを生成 THEN システムは現実的なタイトル、説明文、関連チャプター、開始・終了日時を設定 SHALL する
3. WHEN タスクを生成 THEN システムは適切なステータス（進行中、レビュー中、完了など）を割り当て SHALL する
4. WHEN タスクを生成 THEN システムは関連するタグ（感情タグ）とアクティビティタイプを関連付け SHALL する

### 要件3

**ユーザーストーリー:** 開発者として、マスターデータ（ステータス、タグ、アクティビティタイプ）が適切に設定されることで、選択肢機能をテストしたい

#### 受入基準

1. WHEN シードスクリプトを実行 THEN システムはタスクステータス（「作業中」「レビュー待ち」「完了」など）を日本語で生成 SHALL する
2. WHEN シードスクリプトを実行 THEN システムは感情タグ（「不安」「確認したい」「迷っている」など）を日本語で生成 SHALL する
3. WHEN シードスクリプトを実行 THEN システムはアクティビティタイプ（「じっくり考える」「試す」「調べる」など）を日本語で生成 SHALL する
4. WHEN マスターデータを生成 THEN システムは適切な表示順序とアイコンを設定 SHALL する

### 要件4

**ユーザーストーリー:** 開発者として、学習ログデータが生成されることで、学習時間追跡機能をテストしたい

#### 受入基準

1. WHEN シードスクリプトを実行 THEN システムは各学生に対して10-30個の学習ログを生成 SHALL する
2. WHEN 学習ログを生成 THEN システムは現実的な学習時間（15分-4時間の範囲）を設定 SHALL する
3. WHEN 学習ログを生成 THEN システムは学習の要約と困ったことの記録を日本語で生成 SHALL する
4. WHEN 学習ログを生成 THEN システムは一部をタスクに関連付け、一部を独立した学習として生成 SHALL する

### 要件5

**ユーザーストーリー:** 開発者として、講師-生徒関係のデータが生成されることで、ブックマーク機能をテストしたい

#### 受入基準

1. WHEN シードスクリプトを実行 THEN システムは講師が気になる生徒をブックマークする関係を生成 SHALL する
2. WHEN シードスクリプトを実行 THEN システムは講師が気になるタスクをブックマークする関係を生成 SHALL する
3. WHEN ブックマーク関係を生成 THEN システムは一部を解決済み、一部を未解決として設定 SHALL する
4. WHEN 講師タスクを生成 THEN システムは対応ログ（AssignmentLog）も関連付けて生成 SHALL する

### 要件6

**ユーザーストーリー:** 開発者として、既存データを安全にクリアして新しいテストデータを生成できることで、クリーンな環境でテストしたい

#### 受入基準

1. WHEN シードスクリプトを実行 THEN システムは既存のテストデータを安全に削除 SHALL する
2. WHEN データを削除 THEN システムは外部キー制約を考慮した正しい順序で削除 SHALL する
3. WHEN シードスクリプトを実行 THEN システムは処理の進行状況をコンソールに出力 SHALL する
4. WHEN エラーが発生 THEN システムは詳細なエラー情報を表示してプロセスを終了 SHALL する

### 要件7

**ユーザーストーリー:** 開発者として、生成されるデータが一貫性を保っていることで、リレーション機能を正しくテストしたい

#### 受入基準

1. WHEN 関連データを生成 THEN システムは参照整合性を保った状態でデータを生成 SHALL する
2. WHEN 日時データを生成 THEN システムは論理的に正しい時系列（開始日時 < 終了日時）を保持 SHALL する
3. WHEN ユーザーロールに依存するデータを生成 THEN システムは適切な権限レベルに応じたデータを生成 SHALL する
4. WHEN テストデータを生成 THEN システムは本番環境と区別できるよう明確にテスト用であることを示す SHALL する
